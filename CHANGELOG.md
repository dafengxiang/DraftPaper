# 更新日志

## [0.2.0] - 2024-12-XX - 重构版本

### 🚀 重大更新

#### 技术栈升级
- ✅ 添加 TypeScript 支持，提升类型安全性
- ✅ 更新依赖版本，修复兼容性问题
- ✅ 添加 ESLint + Prettier 代码规范工具
- ✅ 重构 webpack 配置支持 TypeScript

#### 安全性增强
- ✅ **修复 XSS 安全漏洞** - 使用 DOMPurify 安全处理图片 URL
- ✅ **修复代码注入风险** - 添加模板代码验证和清理
- ✅ **限制扩展权限** - 移除 `<all_urls>` 权限，仅在必要网站运行
- ✅ **添加 CSP 策略** - 防止恶意脚本执行
- ✅ **文件上传验证** - 严格验证图片文件类型和大小

#### 性能优化
- ✅ **防抖处理** - 避免频繁的数据库写入和消息发送
- ✅ **内存管理** - 修复内存泄漏，添加资源清理
- ✅ **图片压缩** - 自动压缩上传的图片，减少存储空间
- ✅ **错误处理** - 完善的错误捕获和用户友好的错误提示

#### 用户体验改进
- ✅ **现代化 UI** - 重新设计界面，支持加载状态和错误提示
- ✅ **无障碍访问** - 添加 aria-label 和语义化标签
- ✅ **操作反馈** - 文件上传进度、保存状态等用户反馈
- ✅ **模板验证** - 实时验证模板代码格式和安全性

#### 代码质量提升
- ✅ **组件化重构** - 模块化代码结构，提升可维护性
- ✅ **类型定义** - 完整的 TypeScript 类型定义
- ✅ **错误边界** - 优雅的错误处理和降级方案
- ✅ **代码注释** - 完善的 JSDoc 注释文档

### 🐛 修复问题

- ✅ 修复 Vue 3 和 vue-template-compiler 版本不兼容问题
- ✅ 修复元素拖拽时的内存泄漏问题
- ✅ 修复窗口大小变化时的性能问题
- ✅ 修复草稿图片显示的 XSS 安全风险
- ✅ 修复模板代码的代码注入漏洞
- ✅ 修复数据库操作的错误处理
- ✅ 修复复制功能的兼容性问题

### 📚 新增功能

- ✅ 图片文件验证和压缩
- ✅ 模板代码实时验证和预览
- ✅ 删除确认对话框
- ✅ 错误提示和状态反馈
- ✅ 加载状态显示
- ✅ 更好的键盘和无障碍支持

### 🔧 开发者体验

- ✅ 完整的 TypeScript 配置
- ✅ ESLint + Prettier 代码格式化
- ✅ 改进的构建脚本
- ✅ 详细的代码注释和文档

### ⚠️ 破坏性变更

- 移除了对 `<all_urls>` 的支持，扩展现在只在 HTTPS 和本地开发环境运行
- 升级到 TypeScript，开发时需要使用 `.ts` 文件
- 更严格的模板代码验证可能影响现有的自定义模板

---

## [0.1.0] - 2024-07-06 - 初始版本

### ✨ 新功能

- 📸 草稿图片上传和管理
- 🎯 元素拖拽定位功能
- ⚙️ 自定义代码模板设置
- 💾 本地数据存储
- 🔄 实时草稿同步

### 🛠️ 技术实现

- Vue 3 前端框架
- IndexedDB 本地存储
- Chrome Extension Manifest V3
- Less 样式预处理